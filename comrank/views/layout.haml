!!! 5
%html
  %head
    %meta{:charset => 'utf-8'}
    - if mobile?
      %meta{:name => 'viewport', :content => 'width=device-width, user-scalable=noinitial-scale=1, maximum-scale=1'}
    %meta{:name => 'Cache-Control', :content => 'no-cache'}
    %meta{:name => 'generator', :content => CxbRank::ENGINE_NAME}
    - if site_top?
      %meta{:name => 'robots', :content => 'index, nofollow'}
      %meta{:name => 'description', :content => settings.description}
    - else
      %meta{:name => 'robots', :content => 'noindex, nofollow'}
    %link{:rel => 'stylesheet', :type => 'text/css', :href => CxbRank::SiteSettings.join_site_style_base('color.css')}
    %link{:rel => 'stylesheet', :type => 'text/css', :href => CxbRank::SiteSettings.join_common_style_base('common.css')}
    - if mobile?
      %link{:rel => 'stylesheet', :type => 'text/css', :href => CxbRank::SiteSettings.join_common_style_base('common_sp.css')}
    - else
      %link{:rel => 'stylesheet', :type => 'text/css', :href => CxbRank::SiteSettings.join_common_style_base('common_pc.css')}
    %link{:rel => 'shortcut icon', :href => CxbRank::SiteSettings.join_site_image_base('favicon.ico')}
    - if site_top?
      %title= settings.site_name
    - elsif defined? fixed_title
      %title= "#{fixed_title} - #{settings.site_name}"
    - elsif defined? error_no or defined? errors
      %title= "エラー - #{settings.site_name}"
    - else
      %title= "#{page_title} - #{settings.site_name}"
    %script{:src => 'http://maplia.jp/script/jquery-2.1.0.min.js'}
    %script{:src => 'http://maplia.jp/script/jquery.disableOnSubmit.js'}
    :javascript
      $(function() {
        $('form').disableOnSubmit();
      });
    - if defined? settings.tracker_id
      :javascript
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', '#{settings.tracker_id}', '#{settings.domain}');
        ga('send', 'pageview');
  %body
    - if !mobile? and session[:user_id].present?
      - session_user = CxbRank::User.find_by_id(session[:user_id])
      %p.current_user
        ユーザーID: 
        = link_to session_user.user_id, CxbRank::SiteSettings.join_site_base(CxbRank::SKILL_LIST_EDIT_URI)
        \/
        = link_to 'ログアウト', "#{CxbRank::SiteSettings.join_site_base(CxbRank::USER_LOGOUT_URI)}?#{Time.now.to_i}" 
    = yield
    - unless defined? error_no or defined? errors
      %address
        Generated by #{link_to CxbRank::ENGINE_NAME, CxbRank::SiteSettings.join_site_base(CxbRank::SITE_TOP_URI)} #{CxbRank::ENGINE_VERSION}
        %br
        Programmed by #{link_to '@maplia', 'https://twitter.com/maplia'}
